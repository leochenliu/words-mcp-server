# 用户自定义词库生成指南

## 1. 功能概述

允许用户通过大模型API为MCP Server生成个性化词库，支持以下功能：

- 自定义单词列表生成
- 指定语言难度级别
- 选择内容风格
- 按兴趣领域筛选

## 2. MCP客户端操作流程

### 2.1 词库统计

```bash
# 查看当前词库统计信息
mcp vocabulary stats

# 输出示例:
Current vocabulary version: v1.2
Total words: 50
Word list: ["algorithm", "blockchain", "cloud", ...]
```

### 2.2 生成新词库

```bash
# 1. 启动MCP客户端
mcp start

# 2. 进入词库生成模式
mcp vocabulary generate

# 3. 设置生成参数
? 单词数量: 20
? 难度级别: B2
? 内容风格: academic
? 兴趣领域: 科技,商业

# 4. 确认生成
Generating vocabulary... Done!
```

### 2.2 更新现有词库

```bash
# 1. 列出已有词库
mcp vocabulary list

# 2. 选择要更新的词库
mcp vocabulary update --id vocab_123

# 3. 设置更新参数
? 新增单词: 10
? 难度调整: +0.5
? 新增兴趣: 人工智能

# 4. 确认更新
Updating vocabulary... Done!
```

## 3. 生成规则

1. **统计要求**
   
   - 每个词库版本必须包含单词总数统计
   - 单词列表数组必须按字母顺序排序
   - 统计信息自动写入meta.json

2. **内容要求**
   
   - 每个单词包含7个标准部分
   - 例句数量3-5个
   - 使用Markdown格式

3. **验证机制**
   
   - 自动检查JSON结构
   - 内容完整性验证

## 4. 存储与版本控制

1. **版本规则**
   
   - 每次生成新词库自动创建新版本(v1.0, v1.1...)
   - 版本号格式：主版本.次版本
   - 重大更新递增主版本，小更新递增次版本

2. **服务器存储**
   
   - 目录结构：
     
     ```
     /user/vocabulary/{user_id}/
     ├── v1.0/
     │   ├── words.json
     │   └── meta.json
     ├── v1.1/
     │   ├── words.json
     │   └── meta.json
     └── current -> v1.1
     ```
   
   - 永久保留所有历史版本
   
   - `current`符号链接指向最新版本

3. **本地存储**
   
   - `~/.mcp/vocabulary/{user_id}`
   - 保留最近5个版本以节省空间
   - 支持`mcp vocabulary rollback`回退到指定版本

## 5. 使用限制

- 每日生成上限：100个单词
- 每分钟API调用：5次
- 单次生成最大单词数：50个
- 最大版本保留数：无限制(服务器)/5个(本地)

## 6. 验收标准

1. **功能测试**
   
   - 生成词库包含指定数量的单词
   - 单词难度符合设定级别
   - 内容风格匹配选择
   - 兴趣领域关键词覆盖率>80%

2. **性能测试**
   
   - 生成100个单词耗时<30秒
   - 客户端内存占用<200MB
   - 网络传输数据量<1MB

3. **兼容性测试**
   
   - 支持Windows/macOS/Linux
   - 适配MCP Client 1.2+

4. **错误处理**
   
   | 错误码 | 说明     | 解决方案      |
   | --- | ------ | --------- |
   | 400 | 无效输入参数 | 检查参数格式    |
   | 429 | 请求频率过高 | 等待1分钟后重试  |
   | 500 | 生成失败   | 检查网络连接后重试 |
   | 503 | 服务不可用  | 联系管理员     |